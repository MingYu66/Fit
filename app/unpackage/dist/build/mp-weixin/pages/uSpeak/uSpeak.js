(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/uSpeak/uSpeak"],{"0957":function(t,e,n){"use strict";n.r(e);var a=n("d5f2"),o=n("3233");for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("e2e4");var c=n("f0c5"),s=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"44fd80b2",null,!1,a["a"],void 0);e["default"]=s.exports},3233:function(t,e,n){"use strict";n.r(e);var a=n("ae22"),o=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},"3d04":function(t,e,n){"use strict";(function(t,e){var a=n("4ea4");n("c84b"),n("a9ff");a(n("66fd"));var o=a(n("0957"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"5b80":function(t,e,n){},ae22:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("0e59"),o=n("f104"),i=n("1218"),c=(n("4ed8"),"https://images.unsplash.com/photo-1657310217094-2214abf4fd88?ixlib=rb-1.2.1&ixid=MnwxMjA3fDF8MHxlZGl0b3JpYWwtZmVlZHwxNTN8fHxlbnwwfHx8fA%3D%3D&auto=format&fit=crop&w=600&q=60"),s={data:function(){return{swiperItems0:[{img:c},{img:c},{img:c}],swiperItems1:[{img:c},{img:c},{img:c}],swiperItems2:[{img:"/static/树洞.jpg"},{img:"/static/树洞.jpg"},{img:"/static/树洞.jpg"}],horizontal:"right",vertical:"bottom",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#ffb347",iconColor:"#fff"},navItems:[{type:0,name:"饮食分享"},{id:1,name:"锻炼分享"},{id:2,name:"情感树洞"}],type:0,navCurrent:3,textareaVal:"",maxWords:100,textareatimer:null,face:"https://images.unsplash.com/photo-1663717249250-804cb861ed74?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxlZGl0b3JpYWwtZmVlZHw5M3x8fGVufDB8fHx8&auto=format&fit=crop&w=100&q=80",commentContents:[],name:"张三",userid:0,avatarCache:new Map}},components:{avatar:a.Avatar},watch:{commentContents:{handler:function(t){var e=this;t.forEach((function(t,n){e.generateAvatar(t.name,n)}))},deep:!0,immediate:!0}},onShow:function(){this.navCurrent=3},onLoad:function(){this.navCurrent=3,this.userid=o.getStorage("id"),console.log(this.userid),this.getlist(),t.hideTabBar()},methods:{navChange:function(t){this.type=t,this.getlist()},generateAvatar:function(e,n){var a=this,o="canvas".concat(n);if(console.log("检查 canvasId: ".concat(o)),console.log("开始生成头像: ".concat(e," (索引: ").concat(n,")")),this.avatarCache.has(e))return console.log("缓存命中 ✅: ".concat(e)),void this.$set(this.commentContents[n],"avatar",this.avatarCache.get(e));this.$nextTick((function(){var i=t.createCanvasContext(o,a),c=a.getColorFromName(e);i.beginPath(),i.arc(25,25,25,0,2*Math.PI),i.clip(),i.setFillStyle(c),i.fillRect(0,0,50,50),i.setFillStyle("#ffffff"),i.setFontSize(20),i.setTextAlign("center"),i.setTextBaseline("middle"),i.fillText(e.charAt(0).toUpperCase(),25,25),console.log("Canvas 绘制中..."),i.draw(!0,(function(){console.log("Canvas 绘制完成，转换图片..."),a.convertCanvasToImage(o,e,n),t.canvasToTempFilePath({canvasId:o,success:function(t){console.log("头像生成成功 ??: ".concat(e),t.tempFilePath),a.$set(a.commentContents[n],"avatar",t.tempFilePath),a.avatarCache.set(e,t.tempFilePath)},fail:function(t){console.error("canvasToTempFilePath 失败 ❌",t)}})}))}))},getColorFromName:function(t){for(var e=["#FF5733","#33FF57","#3357FF","#FF33A1","#FFD700"],n=0,a=0;a<t.length;a++)n=t.charCodeAt(a)+((n<<5)-n);return console.log(e[Math.abs(n%e.length)]),e[Math.abs(n%e.length)]},deleSpack:function(t){var e=this;i.post("bohe/deleSpack",{data:{id:t,type:this.type}},(function(t){e.getlist()}))},navChang:function(e){console.log(e),0==e?t.switchTab({url:"../switchPages/index"}):1==e?t.navigateTo({url:"../note/list"}):2==e?t.switchTab({url:"../switchPages/index"}):3==e?t.switchTab({url:"../uSpeak/uSpeak",fail:function(t){console.log(t)}}):4==e&&t.switchTab({url:"../switchPages/about"}),this.navCurrent=e},getlist:function(){this.userid=o.getStorage("id"),this.username=o.getStorage("name");var e={userid:this.userid,type:this.type},n=this;i.post("bohe/Articelist",{data:e},(function(e){console.log(e.data),n.commentContents=e.data,n.commentContents.forEach((function(t,e){n.generateAvatar(t.name,e)})),setTimeout((function(){t.createSelectorQuery().selectAll("canvas").boundingClientRect((function(t){console.log("所有 Canvas:",t)})).exec()}),1e3),console.log(n.commentContents)}))},extractColorByName:function(t){var e=[];e.push("#");for(var n=0;n<t.length;n++)e.push(parseInt(t[n].charCodeAt(0),10).toString(16));return e.slice(0,5).join("").slice(0,4)},open1:function(){this.$refs.guimodal1.open()},close1:function(){this.$refs.guimodal1.close()},confirm1:function(){var t=this;console.log(this.textareaVal);var e={uid:this.userid,content:this.textareaVal,name:this.username,type:this.type};i.post("bohe/bhArticeadd",{data:e},(function(e){console.log(e.data),200==e.data.code&&(t.getlist(),t.$refs.guimodal1.close())}))},love:function(t){var e=this;this.commentContents[t];var n=this.commentContents,a={uid:parseInt(this.userid),aid:this.commentContents[t].id};console.log(a),i.post("bohe/bhALoveadd",{data:a},(function(a){console.log(a.data),200==a.data.code&&(n[t]=a.data.data),e.commentContents=n,e.$forceUpdate()})),console.log(e.commentContents)}}};e.default=s}).call(this,n("543d")["default"])},d5f2:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var a={guiPage:function(){return n.e("GraceUI5/components/gui-page").then(n.bind(null,"674e"))},guiDemoHeader:function(){return n.e("GraceUI5/components/gui-demo-header").then(n.bind(null,"c207"))},guiSwiper:function(){return n.e("GraceUI5/components/gui-swiper").then(n.bind(null,"2ece"))},guiSwitchNavigation:function(){return n.e("GraceUI5/components/gui-switch-navigation").then(n.bind(null,"81d4"))},guiModal:function(){return n.e("GraceUI5/components/gui-modal").then(n.bind(null,"d8ae"))},uniFab:function(){return n.e("uni_modules/uni-fab/components/uni-fab/uni-fab").then(n.bind(null,"36b4"))}},o=function(){var t=this.$createElement;this._self._c},i=[]},e2e4:function(t,e,n){"use strict";var a=n("5b80"),o=n.n(a);o.a}},[["3d04","common/runtime","common/vendor"]]]);